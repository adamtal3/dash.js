{"version":3,"sources":["../../../../src/core/Debug.js"],"names":["EventBus","Events","FactoryMaker","LOG_LEVEL_NONE","LOG_LEVEL_FATAL","LOG_LEVEL_ERROR","LOG_LEVEL_WARNING","LOG_LEVEL_INFO","LOG_LEVEL_DEBUG","Debug","context","eventBus","getInstance","logFn","instance","showLogTimestamp","showCalleeName","startTime","logLevel","setup","Date","getTime","window","console","getLogFn","error","warn","info","debug","fn","bind","log","getLogger","fatal","setLogLevel","value","getLogLevel","setLogTimestampVisible","setCalleeNameVisible","setLogToBrowserConsole","getLogToBrowserConsole","params","doLog","level","_this","message","logTime","getClassName","getType","length","Array","apply","forEach","item","trigger","LOG","__dashjs_factory_name","factory","getSingletonFactory","updateSingletonFactory"],"mappings":"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","file":"Debug.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport EventBus from './EventBus';\nimport Events from './events/Events';\nimport FactoryMaker from './FactoryMaker';\n\nconst LOG_LEVEL_NONE = 0;\nconst LOG_LEVEL_FATAL = 1;\nconst LOG_LEVEL_ERROR = 2;\nconst LOG_LEVEL_WARNING = 3;\nconst LOG_LEVEL_INFO = 4;\nconst LOG_LEVEL_DEBUG = 5;\n\n/**\n * @module Debug\n */\nfunction Debug() {\n\n    const context = this.context;\n    const eventBus = EventBus(context).getInstance();\n\n    const logFn = [];\n\n    let instance,\n        showLogTimestamp,\n        showCalleeName,\n        startTime,\n        logLevel;\n\n    function setup() {\n        showLogTimestamp = true;\n        showCalleeName = true;\n        logLevel = LOG_LEVEL_WARNING;\n        startTime = new Date().getTime();\n\n        if (typeof window !== 'undefined' && window.console) {\n            logFn[LOG_LEVEL_FATAL] = getLogFn(window.console.error);\n            logFn[LOG_LEVEL_ERROR] = getLogFn(window.console.error);\n            logFn[LOG_LEVEL_WARNING] = getLogFn(window.console.warn);\n            logFn[LOG_LEVEL_INFO] = getLogFn(window.console.info);\n            logFn[LOG_LEVEL_DEBUG] = getLogFn(window.console.debug);\n        }\n    }\n\n    function getLogFn(fn) {\n        if (fn && fn.bind) {\n            return fn.bind(window.console);\n        }\n        // if not define, return the default function for reporting logs\n        return window.console.log.bind(window.console);\n    }\n\n    /**\n     * Retrieves a logger which can be used to write logging information in browser console.\n     * @param {object} instance Object for which the logger is created. It is used\n     * to include calle object information in log messages.\n     * @memberof module:Debug\n     * @returns {Logger}\n     * @instance\n     */\n    function getLogger(instance) {\n        return {\n            fatal: fatal.bind(instance),\n            error: error.bind(instance),\n            warn: warn.bind(instance),\n            info: info.bind(instance),\n            debug: debug.bind(instance)\n        };\n    }\n\n    /**\n     * Sets up the log level. The levels are cumulative. For example, if you set the log level\n     * to dashjs.Debug.LOG_LEVEL_WARNING all warnings, errors and fatals will be logged. Possible values\n     *\n     * <ul>\n     * <li>dashjs.Debug.LOG_LEVEL_NONE<br/>\n     * No message is written in the browser console.\n     *\n     * <li>dashjs.Debug.LOG_LEVEL_FATAL<br/>\n     * Log fatal errors. An error is considered fatal when it causes playback to fail completely.\n     *\n     * <li>dashjs.Debug.LOG_LEVEL_ERROR<br/>\n     * Log error messages.\n     *\n     * <li>dashjs.Debug.LOG_LEVEL_WARNING<br/>\n     * Log warning messages.\n     *\n     * <li>dashjs.Debug.LOG_LEVEL_INFO<br/>\n     * Log info messages.\n     *\n     * <li>dashjs.Debug.LOG_LEVEL_DEBUG<br/>\n     * Log debug messages.\n     * </ul>\n     * @param {number} value Log level\n     * @default true\n     * @memberof module:Debug\n     * @instance\n     */\n    function setLogLevel(value) {\n        logLevel = value;\n    }\n\n    /**\n     * Use this method to get the current log level.\n     * @memberof module:Debug\n     * @instance\n     */\n    function getLogLevel() {\n        return logLevel;\n    }\n\n    /**\n     * Prepends a timestamp in milliseconds to each log message.\n     * @param {boolean} value Set to true if you want to see a timestamp in each log message.\n     * @default LOG_LEVEL_WARNING\n     * @memberof module:Debug\n     * @instance\n     */\n    function setLogTimestampVisible(value) {\n        showLogTimestamp = value;\n    }\n    /**\n     * Prepends the callee object name, and media type if available, to each log message.\n     * @param {boolean} value Set to true if you want to see the callee object name and media type in each log message.\n     * @default true\n     * @memberof module:Debug\n     * @instance\n     */\n    function setCalleeNameVisible(value) {\n        showCalleeName = value;\n    }\n    /**\n     * Toggles logging to the browser's javascript console.  If you set to false you will still receive a log event with the same message.\n     * @param {boolean} value Set to false if you want to turn off logging to the browser's console.\n     * @default true\n     * @memberof module:Debug\n     * @instance\n     * @deprecated\n     */\n    function setLogToBrowserConsole(value) {\n        // Replicate functionality previous to log levels feature\n        if (value) {\n            logLevel = LOG_LEVEL_DEBUG;\n        } else {\n            logLevel = LOG_LEVEL_NONE;\n        }\n    }\n    /**\n     * Use this method to get the state of logToBrowserConsole.\n     * @returns {boolean} The current value of logToBrowserConsole\n     * @memberof module:Debug\n     * @instance\n     * @deprecated\n     */\n    function getLogToBrowserConsole() {\n        return logLevel !== LOG_LEVEL_NONE;\n    }\n\n    function fatal(...params) {\n        doLog(LOG_LEVEL_FATAL, this, ...params);\n    }\n\n    function error(...params) {\n        doLog(LOG_LEVEL_ERROR, this, ...params);\n    }\n\n    function warn(...params) {\n        doLog(LOG_LEVEL_WARNING, this, ...params);\n    }\n\n    function info(...params) {\n        doLog(LOG_LEVEL_INFO, this, ...params);\n    }\n\n    function debug(...params) {\n        doLog(LOG_LEVEL_DEBUG, this, ...params);\n    }\n\n    function doLog(level, _this, ...params) {\n        let message = '';\n        let logTime = null;\n\n        if (showLogTimestamp) {\n            logTime = new Date().getTime();\n            message += '[' + (logTime - startTime) + ']';\n        }\n\n        if (showCalleeName && _this && _this.getClassName) {\n            message += '[' + _this.getClassName() + ']';\n            if (_this.getType) {\n                message += '[' + _this.getType() + ']';\n            }\n        }\n\n        if (message.length > 0) {\n            message += ' ';\n        }\n\n        Array.apply(null, params).forEach(function (item) {\n            message += item + ' ';\n        });\n\n        // log to console if the log level is high enough\n        if (logFn[level] && logLevel >= level) {\n            logFn[level](message);\n        }\n\n        // send log event regardless of log level\n        eventBus.trigger(Events.LOG, {message: message, level: level});\n    }\n\n    instance = {\n        getLogger: getLogger,\n        setLogTimestampVisible: setLogTimestampVisible,\n        setCalleeNameVisible: setCalleeNameVisible,\n        setLogToBrowserConsole: setLogToBrowserConsole,\n        getLogToBrowserConsole: getLogToBrowserConsole,\n        setLogLevel: setLogLevel,\n        getLogLevel: getLogLevel\n    };\n\n    setup();\n\n    return instance;\n}\n\nDebug.__dashjs_factory_name = 'Debug';\n\nconst factory = FactoryMaker.getSingletonFactory(Debug);\nfactory.LOG_LEVEL_NONE = LOG_LEVEL_NONE;\nfactory.LOG_LEVEL_FATAL = LOG_LEVEL_FATAL;\nfactory.LOG_LEVEL_ERROR = LOG_LEVEL_ERROR;\nfactory.LOG_LEVEL_WARNING = LOG_LEVEL_WARNING;\nfactory.LOG_LEVEL_INFO = LOG_LEVEL_INFO;\nfactory.LOG_LEVEL_DEBUG = LOG_LEVEL_DEBUG;\nFactoryMaker.updateSingletonFactory(Debug.__dashjs_factory_name, factory);\nexport default factory;\n"]}