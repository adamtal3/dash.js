{"version":3,"sources":["../../../../../src/streaming/utils/CustomTimeRanges.js"],"names":["FactoryMaker","checkInteger","CustomTimeRanges","customTimeRangeArray","length","add","start","end","i","splice","mergeRanges","clear","remove","rangeIndex1","rangeIndex2","range1","range2","index","NaN","__dashjs_factory_name","getClassFactory"],"mappings":"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","file":"CustomTimeRanges.js","sourcesContent":["/**\n* The copyright in this software is being made available under the BSD License,\n* included below. This software may be subject to other third party and contributor\n* rights, including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2013, Dash Industry Forum.\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification,\n* are permitted provided that the following conditions are met:\n*  * Redistributions of source code must retain the above copyright notice, this\n*  list of conditions and the following disclaimer.\n*  * Redistributions in binary form must reproduce the above copyright notice,\n*  this list of conditions and the following disclaimer in the documentation and/or\n*  other materials provided with the distribution.\n*  * Neither the name of Dash Industry Forum nor the names of its\n*  contributors may be used to endorse or promote products derived from this software\n*  without specific prior written permission.\n*\n*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n*  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n*  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n*  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n*  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n*  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n*  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n*  POSSIBILITY OF SUCH DAMAGE.\n*/\nimport FactoryMaker from '../../core/FactoryMaker';\nimport { checkInteger } from '../utils/SupervisorTools';\n\nfunction CustomTimeRanges(/*config*/) {\n    let customTimeRangeArray = [];\n    let length = 0;\n\n    function add(start, end) {\n        let i = 0;\n\n        for (i = 0; (i < this.customTimeRangeArray.length) && (start > this.customTimeRangeArray[i].start); i++);\n\n        this.customTimeRangeArray.splice(i, 0, {start: start,end: end});\n\n        for (i = 0; i < this.customTimeRangeArray.length - 1; i++) {\n            if (this.mergeRanges(i,i + 1)) {\n                i--;\n            }\n        }\n        this.length = this.customTimeRangeArray.length;\n    }\n\n    function clear() {\n        this.customTimeRangeArray = [];\n        this.length = 0;\n    }\n\n    function remove(start, end) {\n        for (let i = 0; i < this.customTimeRangeArray.length; i++) {\n            if (start <= this.customTimeRangeArray[i].start && end >= this.customTimeRangeArray[i].end) {\n                //      |--------------Range i-------|\n                //|---------------Range to remove ---------------|\n                //    or\n                //|--------------Range i-------|\n                //|--------------Range to remove ---------------|\n                //    or\n                //                 |--------------Range i-------|\n                //|--------------Range to remove ---------------|\n                this.customTimeRangeArray.splice(i,1);\n                i--;\n\n            } else if (start > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n                //|-----------------Range i----------------|\n                //        |-------Range to remove -----|\n                this.customTimeRangeArray.splice(i + 1, 0, {start: end,end: this.customTimeRangeArray[i].end});\n                this.customTimeRangeArray[i].end = start;\n                break;\n            } else if ( start > this.customTimeRangeArray[i].start && start < this.customTimeRangeArray[i].end) {\n                //|-----------Range i----------|\n                //                    |---------Range to remove --------|\n                //    or\n                //|-----------------Range i----------------|\n                //            |-------Range to remove -----|\n                this.customTimeRangeArray[i].end = start;\n            } else if ( end > this.customTimeRangeArray[i].start && end < this.customTimeRangeArray[i].end) {\n                //                     |-----------Range i----------|\n                //|---------Range to remove --------|\n                //            or\n                //|-----------------Range i----------------|\n                //|-------Range to remove -----|\n                this.customTimeRangeArray[i].start = end;\n            }\n        }\n\n        this.length = this.customTimeRangeArray.length;\n    }\n\n    function mergeRanges(rangeIndex1, rangeIndex2) {\n        let range1 = this.customTimeRangeArray[rangeIndex1];\n        let range2 = this.customTimeRangeArray[rangeIndex2];\n\n        if (range1.start <=  range2.start && range2.start <= range1.end && range1.end <= range2.end) {\n            //|-----------Range1----------|\n            //                    |-----------Range2----------|\n            range1.end = range2.end;\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n\n        } else if (range2.start <= range1.start && range1.start <= range2.end && range2.end <= range1.end) {\n            //                |-----------Range1----------|\n            //|-----------Range2----------|\n            range1.start = range2.start;\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n        } else if (range2.start <= range1.start && range1.start <= range2.end && range1.end <= range2.end) {\n            //      |--------Range1-------|\n            //|---------------Range2--------------|\n            this.customTimeRangeArray.splice(rangeIndex1,1);\n            return true;\n        } else if (range1.start <= range2.start && range2.start <= range1.end && range2.end <= range1.end) {\n            //|-----------------Range1--------------|\n            //        |-----------Range2----------|\n            this.customTimeRangeArray.splice(rangeIndex2,1);\n            return true;\n        }\n        return false;\n    }\n\n    function start(index) {\n        checkInteger(index);\n\n        if (index >= this.customTimeRangeArray.length || index < 0) {\n            return NaN;\n        }\n\n        return this.customTimeRangeArray[index].start;\n    }\n\n    function end(index) {\n        checkInteger(index);\n\n        if (index >= this.customTimeRangeArray.length || index < 0) {\n            return NaN;\n        }\n\n        return this.customTimeRangeArray[index].end;\n    }\n\n    return {\n        customTimeRangeArray: customTimeRangeArray,\n        length: length,\n        add: add,\n        clear: clear,\n        remove: remove,\n        mergeRanges: mergeRanges,\n        start: start,\n        end: end\n    };\n}\nCustomTimeRanges.__dashjs_factory_name = 'CustomTimeRanges';\nexport default FactoryMaker.getClassFactory(CustomTimeRanges);\n"]}